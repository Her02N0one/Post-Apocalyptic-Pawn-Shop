# ═══════════════════════════════════════════════════════════════════════
#  GAME TUNING CONSTANTS
#  All gameplay numbers live here. Systems read via core.tuning.get().
#  Hot-reloadable: press F4 in-game to reload without restarting.
# ═══════════════════════════════════════════════════════════════════════


# ─── COMBAT: MELEE ───────────────────────────────────────────────────

[combat.melee]
default_knockback           = 3.0
default_crit_chance          = 0.1
default_crit_mult            = 1.5
damage_variance_min          = 0.8
damage_variance_max          = 1.2
min_base_damage              = 1.0
default_weapon_reach         = 1.5
no_weapon_reach              = 1.0
hit_flash_duration           = 0.1
fallback_hurtbox_w           = 0.8
fallback_hurtbox_h           = 0.8


# ─── COMBAT: RANGED / PROJECTILE ────────────────────────────────────

[combat.ranged]
default_accuracy             = 0.7
default_proj_speed           = 12.0
default_max_range            = 10.0
accuracy_spread_factor       = 0.4
projectile_spawn_offset      = 0.5
projectile_falloff_min       = 0.5


# ─── COMBAT: ENGAGEMENT FSM ─────────────────────────────────────────

[combat.engagement]
chase_mult_ranged            = 1.2
chase_mult_melee             = 1.4
flee_speed_mult              = 1.3
return_speed_mult_melee      = 1.5
kite_close_factor            = 0.4
kite_away_speed_mult         = 1.3

ranged_chase_to_attack       = 1.1
ranged_attack_to_chase       = 1.8
melee_attack_to_chase        = 1.6
melee_close_in_factor        = 0.5
melee_close_in_speed         = 0.5

strafe_timer_los_min         = 0.4
strafe_timer_los_max         = 0.8
strafe_timer_normal_min      = 0.8
strafe_timer_normal_max      = 2.0
strafe_speed_los_mult        = 1.2
strafe_speed_normal_mult     = 0.6

flee_recovery_mult           = 2.5
return_arrive_dist           = 1.0
return_reaggro_factor        = 0.6
chase_give_up_mult           = 2.0

ally_near_target_factor      = 0.8
line_of_fire_clearance       = 0.6

fallback_patrol_speed        = 2.0


# ─── AI: HELPERS (DODGE / HEAL / IDLE) ───────────────────────────────

[ai.helpers]
path_recompute_interval      = 0.8
path_target_drift_threshold  = 1.5
waypoint_reach               = 0.55

dodge_speed_mult             = 3.0
dodge_duration               = 1.5
heal_hp_threshold            = 0.4
heal_cooldown                = 5.0

idle_wander_speed_min        = 0.2
idle_wander_speed_max        = 0.5
idle_timer_min               = 1.5
idle_timer_max               = 4.0
idle_return_speed_mult       = 0.3
idle_blocked_timer           = 0.1


# ─── AI: VILLAGER BRAIN ─────────────────────────────────────────────

[ai.villager]
day_length                   = 300.0

morning_start                = 0.00
morning_end                  = 0.30
midday_start                 = 0.30
midday_end                   = 0.45
afternoon_start              = 0.45
afternoon_end                = 0.75
evening_start                = 0.75
evening_end                  = 1.00

eat_pause                    = 2.0
eat_threshold                = 0.4
arrive_dist                  = 2.5
social_dist                  = 4.0

waypoint_reach               = 0.55
stuck_check_interval         = 1.0
stuck_move_threshold         = 0.3
stuck_strikes                = 3

path_recompute_interval      = 1.5
crime_flee_speed_mult        = 1.6

forage_duration_min          = 8.0
forage_duration_max          = 15.0
forage_speed_mult            = 1.3

greet_cooldown_min           = 3.0
greet_cooldown_max           = 8.0
social_wander_speed_mult     = 0.4
morning_wander_speed_mult    = 0.5

wander_pick_min              = 2.0
wander_pick_max              = 4.5


# ─── AI: WANDER BRAIN ───────────────────────────────────────────────

[ai.wander]
pick_interval_min            = 2.0
pick_interval_max            = 5.0
max_dest_attempts            = 8
min_dest_radius              = 2.0
waypoint_reach               = 0.55
path_speed_min_mult          = 0.5
fallback_timer_min           = 1.0
fallback_timer_max           = 3.0


# ─── LOD SYSTEM ──────────────────────────────────────────────────────
# high_radius: entities within this distance of the player = high LOD
# Entities further away but in the same zone = medium LOD (still active)
# Entities in a different zone = low LOD (event-driven only)

[lod]
high_radius                  = 20.0
grace_period                 = 0.5
lod_interval                 = 0.25


# ─── NEEDS SYSTEM ────────────────────────────────────────────────────

[needs]
well_fed_ratio               = 0.5
hungry_ratio                 = 0.25
eat_cooldown                 = 30.0
fallback_food_value          = 25.0

[needs.storehouse_refill]
refill_interval              = 300.0
refill_default_cap           = 20

[needs.storehouse_refill.items]
stew                         = 3
ration                       = 5

[needs.storehouse_refill.max_stock]
stew                         = 20
ration                       = 30
canned_beans                 = 15
dried_meat                   = 15


# ─── CRIME ───────────────────────────────────────────────────────────

[crime]
witness_radius               = 8.0
crime_memory_ttl             = 1200.0
crime_flee_duration          = 20.0


# ─── PATHFINDING ─────────────────────────────────────────────────────

[pathfinding]
max_dist_default             = 32
waypoint_reach               = 0.5
wall_margin_penalty          = 2.0
agent_size                   = 0.8

[pathfinding.penalties]
void                         = -1
grass                        =  0
dirt                         =  0
stone                        =  0
water                        =  8
wood_floor                   =  0
wall                         = -1
teleporter                   =  0


# ─── PARTICLES ───────────────────────────────────────────────────────

[particles]
max_particles                = 512

[particles.hit_normal]
count                        = 6
color                        = [255, 50, 50]
speed                        = 2.5
life                         = 0.3
size                         = 2.0

[particles.hit_crit]
count                        = 12
color                        = [255, 200, 50]
speed                        = 2.5
life                         = 0.3
size                         = 2.0

[particles.death]
count                        = 20
color                        = [180, 30, 30]
speed                        = 3.5
life                         = 0.6
size                         = 2.5
gravity                      = 4.0

[particles.muzzle_flash]
count                        = 3
color                        = [255, 180, 60]
speed                        = 1.5
life                         = 0.1
size                         = 1.0


# ─── COMPONENT DEFAULTS ─────────────────────────────────────────────

[defaults.health]
current                      = 100.0
maximum                      = 100.0

[defaults.hunger]
current                      = 80.0
maximum                      = 100.0
rate                         = 0.03
starve_dps                   = 0.3

[defaults.patrol]
radius                       = 5.0
speed                        = 2.0

[defaults.threat]
aggro_radius                 = 8.0
leash_radius                 = 15.0
flee_threshold               = 0.2
sensor_interval              = 0.1

[defaults.attack_config]
attack_type                  = "melee"
range                        = 1.2
cooldown                     = 0.5

[defaults.faction]
alert_radius                 = 12.0
